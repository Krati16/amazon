{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.add = void 0;\nvar isDirtyPropWithPre = function (dirtyProp) {\n  return !!dirtyProp.preDirty;\n};\nvar isDirtyPropWithOn = function (dirtyProp) {\n  return !!dirtyProp.onDirty;\n};\nfunction add(obj, props, dirtyCleans) {\n  props.forEach(function (prop) {\n    var val;\n    var name = prop.name || prop;\n    var initialVal = obj[name];\n    Object.defineProperty(obj, name, {\n      enumerable: true,\n      get: function () {\n        return val;\n      },\n      set: function (newVal) {\n        var oldVal = val;\n        var isChanged = newVal !== oldVal;\n        if (isChanged && isDirtyPropWithPre(prop)) {\n          prop.preDirty();\n        }\n        val = newVal;\n        if (isChanged) {\n          dirtyCleans.forEach(function (dirtyClean) {\n            dirtyClean.setDirty();\n          });\n          if (isDirtyPropWithOn(prop)) {\n            prop.onDirty(newVal, oldVal);\n          }\n        }\n      }\n    });\n    obj[name] = initialVal;\n  });\n  return obj;\n}\nexports.add = add;\nexports.default = add;","map":{"version":3,"names":["isDirtyPropWithPre","dirtyProp","preDirty","isDirtyPropWithOn","onDirty","add","obj","props","dirtyCleans","forEach","prop","val","name","initialVal","Object","defineProperty","enumerable","get","set","newVal","oldVal","isChanged","dirtyClean","setDirty","exports","default"],"sources":["C:\\amazon\\amazon\\node_modules\\grid\\src\\modules\\dirty-props\\index.ts"],"sourcesContent":["import { IDirtyClean } from '../dirty-clean';\n\nexport interface IHasPreDirty {\n    preDirty(): void;\n}\n\nexport interface IHasOnDirty {\n    onDirty<T>(newVal: T, oldVal: T): void;\n}\n\nexport interface IDirtyProp extends Partial<IHasPreDirty>, Partial<IHasOnDirty> {\n    name: string;\n}\n\nexport type DirtyProp = string | IDirtyProp;\n\nconst isDirtyPropWithPre =\n    (dirtyProp: any): dirtyProp is IHasPreDirty =>\n        !!(dirtyProp as IDirtyProp).preDirty;\nconst isDirtyPropWithOn =\n    (dirtyProp: any): dirtyProp is IHasOnDirty =>\n        !!(dirtyProp as IDirtyProp).onDirty;\n\nexport function add<T>(obj: T, props: DirtyProp[], dirtyCleans: IDirtyClean[]) {\n    props.forEach((prop) => {\n        let val: any;\n        const name = (prop as IDirtyProp).name || prop as string;\n        // store the value if it was already there\n        const initialVal = (obj as any)[name];\n        Object.defineProperty(obj, name, {\n            enumerable: true,\n            get() {\n                return val;\n            },\n            set(newVal: any) {\n                const oldVal = val;\n                const isChanged = newVal !== oldVal;\n                if (isChanged && isDirtyPropWithPre(prop)) {\n                    prop.preDirty();\n                }\n                val = newVal;\n\n                if (isChanged) {\n                    dirtyCleans.forEach((dirtyClean) => {\n                        dirtyClean.setDirty();\n                    });\n                    if (isDirtyPropWithOn(prop)) {\n                        prop.onDirty(newVal, oldVal);\n                    }\n                }\n            }\n        });\n        // reset the initial value both to keep it and to trigger the dirty logic\n        (obj as any)[name] = initialVal;\n    });\n    return obj;\n}\n\nexport default add;"],"mappings":";;;;;;AAgBA,IAAMA,kBAAkB,GACpB,SAAAA,CAACC,SAAc;EACX,QAAC,CAAEA,SAAwB,CAACC,QAAQ;AAApC,CAAoC;AAC5C,IAAMC,iBAAiB,GACnB,SAAAA,CAACF,SAAc;EACX,QAAC,CAAEA,SAAwB,CAACG,OAAO;AAAnC,CAAmC;AAE3C,SAAgBC,GAAGA,CAAIC,GAAM,EAAEC,KAAkB,EAAEC,WAA0B;EACzED,KAAK,CAACE,OAAO,CAAC,UAACC,IAAI;IACf,IAAIC,GAAQ;IACZ,IAAMC,IAAI,GAAIF,IAAmB,CAACE,IAAI,IAAIF,IAAc;IAExD,IAAMG,UAAU,GAAIP,GAAW,CAACM,IAAI,CAAC;IACrCE,MAAM,CAACC,cAAc,CAACT,GAAG,EAAEM,IAAI,EAAE;MAC7BI,UAAU,EAAE,IAAI;MAChBC,GAAG,WAAAA,CAAA;QACC,OAAON,GAAG;MACd,CAAC;MACDO,GAAG,EAAH,SAAAA,CAAIC,MAAW;QACX,IAAMC,MAAM,GAAGT,GAAG;QAClB,IAAMU,SAAS,GAAGF,MAAM,KAAKC,MAAM;QACnC,IAAIC,SAAS,IAAIrB,kBAAkB,CAACU,IAAI,CAAC,EAAE;UACvCA,IAAI,CAACR,QAAQ,EAAE;;QAEnBS,GAAG,GAAGQ,MAAM;QAEZ,IAAIE,SAAS,EAAE;UACXb,WAAW,CAACC,OAAO,CAAC,UAACa,UAAU;YAC3BA,UAAU,CAACC,QAAQ,EAAE;UACzB,CAAC,CAAC;UACF,IAAIpB,iBAAiB,CAACO,IAAI,CAAC,EAAE;YACzBA,IAAI,CAACN,OAAO,CAACe,MAAM,EAAEC,MAAM,CAAC;;;MAGxC;KACH,CAAC;IAEDd,GAAW,CAACM,IAAI,CAAC,GAAGC,UAAU;EACnC,CAAC,CAAC;EACF,OAAOP,GAAG;AACd;AAjCAkB,OAAA,CAAAnB,GAAA,GAAAA,GAAA;AAmCAmB,OAAA,CAAAC,OAAA,GAAepB,GAAG","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}